function calc_mod(e,t){let n;return n=e<0n?e+t<0n?(-1n*e/t+1n)*t+e:e+t:e%t,n}function extended_euclidean_algorithm(e,t){let n,i,s,r,l=e,o=t,a=1n,d=0n,c=0n,u=1n;for(;0n!==o;)r=l<0n&&o<0n?l/o:l<0n||o<0n?l/o-1n:l/o,n=l-r*o,l=o,o=n,i=a-r*d,a=d,d=i,s=c-r*u,c=u,u=s;return[l,a,c]}function inverse(e,t){const[n,i,s]=extended_euclidean_algorithm(e,t);return calc_mod(i,t)}class Point{constructor(e,t){this.curve_p=0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2Fn,this.curve_a=0x0000000000000000000000000000000000000000000000000000000000000000n,this.curve_b=0x0000000000000000000000000000000000000000000000000000000000000007n,this.x=e,this.y=t}add(e){if(this==INF)return e;if(e==INF)return this;if(this.x==e.x&&this.y!=e.y)return INF;let t,n,i;return this.x==e.x?(t=(3n*this.x**2n+this.curve_a)*inverse(2n*this.y,this.curve_p),t=calc_mod(t,this.curve_p)):(t=(this.y-e.y)*inverse(this.x-e.x,this.curve_p),t=calc_mod(t,this.curve_p)),n=t**2n-this.x-e.x,n=calc_mod(n,this.curve_p),i=t*(this.x-n)-this.y,i=calc_mod(i,this.curve_p),new Point(n,i)}multiply(e){let t=INF,n=this;for(;e;)1n&e&&(t=t.add(n)),n=n.add(n),e>>=1n;return t}}const Gx=0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798n,Gy=0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,ORD_G=0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141n;INF=new Point(null,null);const G=new Point(Gx,Gy);function rotr(e,t,n=32){return(e>>>t|e<<n-t&2**n-1)>>>0}function shr(e,t){return e>>>t}function ch(e,t,n){return(e&t^~e&n)>>>0}function maj(e,t,n){return(e&t^e&n^t&n)>>>0}function sig0(e){return(rotr(e,7)^rotr(e,18)^shr(e,3))>>>0}function sig1(e){return(rotr(e,17)^rotr(e,19)^shr(e,10))>>>0}function capsig0(e){return(rotr(e,2)^rotr(e,13)^rotr(e,22))>>>0}function capsig1(e){return(rotr(e,6)^rotr(e,11)^rotr(e,25))>>>0}function first_n_primes(e){const t=[];let n=2,i=!0;for(let s=0;s<e;n++){for(let e=2;e*e<=n;e++)if(n%e==0){i=!1;break}i?(t.push(n),s++):i=!0}return t}function frac_bin(e){let t=e-Math.floor(e);return t*=4294967296,t=parseInt(t),t}function genK(){const e=new Uint32Array(64);return first_n_primes(64).forEach((function(t,n){e[n]=frac_bin(Math.pow(t,1/3))})),e}function genH(){const e=new Uint32Array(8);return first_n_primes(8).forEach((function(t,n){e[n]=frac_bin(Math.pow(t,.5))})),e}function hexStringToArray_sha(e){const t=[],n=parseInt(e.length/8),i=e.length%8;for(let i=0;i<n;i++)t.push(parseInt(e.substring(8*i,8*i+8),16));return i&&t.push(parseInt(e.substring(8*n),16)),t}function pad_sha(e){const t=4*e.length,n=e.length%8*4,i=hexStringToArray_sha(e),s=new Uint32Array(i);let r,l=[];for(0===n?l.push(1<<31>>>0):8!==n&&16!==n&&24!==n||(r=s[s.length-1],r=(r<<32-n|1<<32-n-1)>>>0,s.fill(r,s.length-1));(32*s.length+32*l.length)%512!=448;)l.push(0);if(!(32*s.length+32*l.length<=2**32-1))throw new Error("Can only hash upto file size of 4GB.");l.push(0),l.push(t);const o=new Uint32Array(s.length+l.length);return s.forEach((function(e,t){o[t]=e})),l.forEach((function(e,t){o[t+s.length]=e})),o}function sha256(e){const t=genK(),n=pad_sha(e),i=32*n.length;let s,r,l,o,a,d,c,u,_,m,g,h,p,f,v,b,K,F,E=genH(),R="";for(let e=0;e<i/512;e++){s=new Uint32Array(64);for(let t=0;t<64;t++)t<=15?s[t]=n[16*e+t]:(l=sig1(s[t-2]),o=s[t-7],a=sig0(s[t-15]),d=s[t-16],c=l+o+a+d>>>0,s[t]=c);[u,_,m,g,h,p,f,v]=E;for(let e=0;e<64;e++)b=v+capsig1(h)+ch(h,p,f)+t[e]+s[e]>>>0,K=capsig0(u)+maj(u,_,m)>>>0,v=f,f=p,p=h,h=g+b>>>0,g=m,m=_,_=u,u=b+K>>>0;r=[u,_,m,g,h,p,f,v],E.forEach((function(e,t){E[t]=r[t]+e>>>0}))}return E.forEach((function(e){F=e.toString(16).padStart(8,"0"),R+=F})),R}let K0=0,K1=1518500249,K2=1859775393,K3=2400959708,K4=2840853838,KK0=1352829926,KK1=1548603684,KK2=1836072691,KK3=2053994217,KK4=0;function ROL(e,t){return(e<<t&4294967295|e>>>32-t)>>>0}function F0(e,t,n){return(e^t^n)>>>0}function F1(e,t,n){return(e&t|~e%4294967296&n)>>>0}function F2(e,t,n){return((e|~t%4294967296)^n)>>>0}function F3(e,t,n){return e&n|(t&~n%4294967296)>>>0}function F4(e,t,n){return(e^(t|~n%4294967296))>>>0}function R(e,t,n,i,s,r,l,o,a,d){return[e=(ROL((e+r(t,n,i)+d[a]+l)%4294967296,o)+s)%4294967296>>>0,n=ROL(n,10)]}function changeEndianness(e){const t=[];let n=parseInt(e.length/2);for(let i=0;i<n;i++)t.unshift(e.substring(2*i,2*i+2));return t.join("")}function hexStringToArray_ripemd(e){const t=[],n=parseInt(e.length/8),i=e.length%8;let s;for(let i=0;i<n;i++)s=changeEndianness(e.substring(8*i,8*i+8)),t.push(parseInt(s,16));return i&&(s=e.substring(8*n),t.push(parseInt(s,16))),t}function pad_ripemd(e){const t=4*e.length,n=e.length%8*4;data=hexStringToArray_ripemd(e);const i=new Uint32Array(data);let s,r=[];for(0===n?r.push(128):8!==n&&16!==n&&24!==n||(s=i[i.length-1],s=(s|1<<n+7)>>>0,i.fill(s,i.length-1));(32*i.length+32*r.length)%512!=448;)r.push(0);if(!(32*i.length+32*r.length<=2**32-1))throw new Error("Can only hash upto file size of 4GB.");r.push(t),r.push(0);const l=new Uint32Array(i.length+r.length);return i.forEach((function(e,t){l[t]=e})),r.forEach((function(e,t){l[t+i.length]=e})),l}function RIPEMD160Transform(e,n){let i,s,r,l,o,a,d,c,u,_;return i=e[0],s=e[1],r=e[2],l=e[3],o=e[4],[i,r]=R(i,s,r,l,o,F0,K0,11,0,n),[o,s]=R(o,i,s,r,l,F0,K0,14,1,n),[l,i]=R(l,o,i,s,r,F0,K0,15,2,n),[r,o]=R(r,l,o,i,s,F0,K0,12,3,n),[s,l]=R(s,r,l,o,i,F0,K0,5,4,n),[i,r]=R(i,s,r,l,o,F0,K0,8,5,n),[o,s]=R(o,i,s,r,l,F0,K0,7,6,n),[l,i]=R(l,o,i,s,r,F0,K0,9,7,n),[r,o]=R(r,l,o,i,s,F0,K0,11,8,n),[s,l]=R(s,r,l,o,i,F0,K0,13,9,n),[i,r]=R(i,s,r,l,o,F0,K0,14,10,n),[o,s]=R(o,i,s,r,l,F0,K0,15,11,n),[l,i]=R(l,o,i,s,r,F0,K0,6,12,n),[r,o]=R(r,l,o,i,s,F0,K0,7,13,n),[s,l]=R(s,r,l,o,i,F0,K0,9,14,n),[i,r]=R(i,s,r,l,o,F0,K0,8,15,n),[o,s]=R(o,i,s,r,l,F1,K1,7,7,n),[l,i]=R(l,o,i,s,r,F1,K1,6,4,n),[r,o]=R(r,l,o,i,s,F1,K1,8,13,n),[s,l]=R(s,r,l,o,i,F1,K1,13,1,n),[i,r]=R(i,s,r,l,o,F1,K1,11,10,n),[o,s]=R(o,i,s,r,l,F1,K1,9,6,n),[l,i]=R(l,o,i,s,r,F1,K1,7,15,n),[r,o]=R(r,l,o,i,s,F1,K1,15,3,n),[s,l]=R(s,r,l,o,i,F1,K1,7,12,n),[i,r]=R(i,s,r,l,o,F1,K1,12,0,n),[o,s]=R(o,i,s,r,l,F1,K1,15,9,n),[l,i]=R(l,o,i,s,r,F1,K1,9,5,n),[r,o]=R(r,l,o,i,s,F1,K1,11,2,n),[s,l]=R(s,r,l,o,i,F1,K1,7,14,n),[i,r]=R(i,s,r,l,o,F1,K1,13,11,n),[o,s]=R(o,i,s,r,l,F1,K1,12,8,n),[l,i]=R(l,o,i,s,r,F2,K2,11,3,n),[r,o]=R(r,l,o,i,s,F2,K2,13,10,n),[s,l]=R(s,r,l,o,i,F2,K2,6,14,n),[i,r]=R(i,s,r,l,o,F2,K2,7,4,n),[o,s]=R(o,i,s,r,l,F2,K2,14,9,n),[l,i]=R(l,o,i,s,r,F2,K2,9,15,n),[r,o]=R(r,l,o,i,s,F2,K2,13,8,n),[s,l]=R(s,r,l,o,i,F2,K2,15,1,n),[i,r]=R(i,s,r,l,o,F2,K2,14,2,n),[o,s]=R(o,i,s,r,l,F2,K2,8,7,n),[l,i]=R(l,o,i,s,r,F2,K2,13,0,n),[r,o]=R(r,l,o,i,s,F2,K2,6,6,n),[s,l]=R(s,r,l,o,i,F2,K2,5,13,n),[i,r]=R(i,s,r,l,o,F2,K2,12,11,n),[o,s]=R(o,i,s,r,l,F2,K2,7,5,n),[l,i]=R(l,o,i,s,r,F2,K2,5,12,n),[r,o]=R(r,l,o,i,s,F3,K3,11,1,n),[s,l]=R(s,r,l,o,i,F3,K3,12,9,n),[i,r]=R(i,s,r,l,o,F3,K3,14,11,n),[o,s]=R(o,i,s,r,l,F3,K3,15,10,n),[l,i]=R(l,o,i,s,r,F3,K3,14,0,n),[r,o]=R(r,l,o,i,s,F3,K3,15,8,n),[s,l]=R(s,r,l,o,i,F3,K3,9,12,n),[i,r]=R(i,s,r,l,o,F3,K3,8,4,n),[o,s]=R(o,i,s,r,l,F3,K3,9,13,n),[l,i]=R(l,o,i,s,r,F3,K3,14,3,n),[r,o]=R(r,l,o,i,s,F3,K3,5,7,n),[s,l]=R(s,r,l,o,i,F3,K3,6,15,n),[i,r]=R(i,s,r,l,o,F3,K3,8,14,n),[o,s]=R(o,i,s,r,l,F3,K3,6,5,n),[l,i]=R(l,o,i,s,r,F3,K3,5,6,n),[r,o]=R(r,l,o,i,s,F3,K3,12,2,n),[s,l]=R(s,r,l,o,i,F4,K4,9,4,n),[i,r]=R(i,s,r,l,o,F4,K4,15,0,n),[o,s]=R(o,i,s,r,l,F4,K4,5,5,n),[l,i]=R(l,o,i,s,r,F4,K4,11,9,n),[r,o]=R(r,l,o,i,s,F4,K4,6,7,n),[s,l]=R(s,r,l,o,i,F4,K4,8,12,n),[i,r]=R(i,s,r,l,o,F4,K4,13,2,n),[o,s]=R(o,i,s,r,l,F4,K4,12,10,n),[l,i]=R(l,o,i,s,r,F4,K4,5,14,n),[r,o]=R(r,l,o,i,s,F4,K4,12,1,n),[s,l]=R(s,r,l,o,i,F4,K4,13,3,n),[i,r]=R(i,s,r,l,o,F4,K4,14,8,n),[o,s]=R(o,i,s,r,l,F4,K4,11,11,n),[l,i]=R(l,o,i,s,r,F4,K4,8,6,n),[r,o]=R(r,l,o,i,s,F4,K4,5,15,n),[s,l]=R(s,r,l,o,i,F4,K4,6,13,n),a=i,d=s,c=r,u=l,_=o,i=e[0],s=e[1],r=e[2],l=e[3],o=e[4],[i,r]=R(i,s,r,l,o,F4,KK0,8,5,n),[o,s]=R(o,i,s,r,l,F4,KK0,9,14,n),[l,i]=R(l,o,i,s,r,F4,KK0,9,7,n),[r,o]=R(r,l,o,i,s,F4,KK0,11,0,n),[s,l]=R(s,r,l,o,i,F4,KK0,13,9,n),[i,r]=R(i,s,r,l,o,F4,KK0,15,2,n),[o,s]=R(o,i,s,r,l,F4,KK0,15,11,n),[l,i]=R(l,o,i,s,r,F4,KK0,5,4,n),[r,o]=R(r,l,o,i,s,F4,KK0,7,13,n),[s,l]=R(s,r,l,o,i,F4,KK0,7,6,n),[i,r]=R(i,s,r,l,o,F4,KK0,8,15,n),[o,s]=R(o,i,s,r,l,F4,KK0,11,8,n),[l,i]=R(l,o,i,s,r,F4,KK0,14,1,n),[r,o]=R(r,l,o,i,s,F4,KK0,14,10,n),[s,l]=R(s,r,l,o,i,F4,KK0,12,3,n),[i,r]=R(i,s,r,l,o,F4,KK0,6,12,n),[o,s]=R(o,i,s,r,l,F3,KK1,9,6,n),[l,i]=R(l,o,i,s,r,F3,KK1,13,11,n),[r,o]=R(r,l,o,i,s,F3,KK1,15,3,n),[s,l]=R(s,r,l,o,i,F3,KK1,7,7,n),[i,r]=R(i,s,r,l,o,F3,KK1,12,0,n),[o,s]=R(o,i,s,r,l,F3,KK1,8,13,n),[l,i]=R(l,o,i,s,r,F3,KK1,9,5,n),[r,o]=R(r,l,o,i,s,F3,KK1,11,10,n),[s,l]=R(s,r,l,o,i,F3,KK1,7,14,n),[i,r]=R(i,s,r,l,o,F3,KK1,7,15,n),[o,s]=R(o,i,s,r,l,F3,KK1,12,8,n),[l,i]=R(l,o,i,s,r,F3,KK1,7,12,n),[r,o]=R(r,l,o,i,s,F3,KK1,6,4,n),[s,l]=R(s,r,l,o,i,F3,KK1,15,9,n),[i,r]=R(i,s,r,l,o,F3,KK1,13,1,n),[o,s]=R(o,i,s,r,l,F3,KK1,11,2,n),[l,i]=R(l,o,i,s,r,F2,KK2,9,15,n),[r,o]=R(r,l,o,i,s,F2,KK2,7,5,n),[s,l]=R(s,r,l,o,i,F2,KK2,15,1,n),[i,r]=R(i,s,r,l,o,F2,KK2,11,3,n),[o,s]=R(o,i,s,r,l,F2,KK2,8,7,n),[l,i]=R(l,o,i,s,r,F2,KK2,6,14,n),[r,o]=R(r,l,o,i,s,F2,KK2,6,6,n),[s,l]=R(s,r,l,o,i,F2,KK2,14,9,n),[i,r]=R(i,s,r,l,o,F2,KK2,12,11,n),[o,s]=R(o,i,s,r,l,F2,KK2,13,8,n),[l,i]=R(l,o,i,s,r,F2,KK2,5,12,n),[r,o]=R(r,l,o,i,s,F2,KK2,14,2,n),[s,l]=R(s,r,l,o,i,F2,KK2,13,10,n),[i,r]=R(i,s,r,l,o,F2,KK2,13,0,n),[o,s]=R(o,i,s,r,l,F2,KK2,7,4,n),[l,i]=R(l,o,i,s,r,F2,KK2,5,13,n),[r,o]=R(r,l,o,i,s,F1,KK3,15,8,n),[s,l]=R(s,r,l,o,i,F1,KK3,5,6,n),[i,r]=R(i,s,r,l,o,F1,KK3,8,4,n),[o,s]=R(o,i,s,r,l,F1,KK3,11,1,n),[l,i]=R(l,o,i,s,r,F1,KK3,14,3,n),[r,o]=R(r,l,o,i,s,F1,KK3,14,11,n),[s,l]=R(s,r,l,o,i,F1,KK3,6,15,n),[i,r]=R(i,s,r,l,o,F1,KK3,14,0,n),[o,s]=R(o,i,s,r,l,F1,KK3,6,5,n),[l,i]=R(l,o,i,s,r,F1,KK3,9,12,n),[r,o]=R(r,l,o,i,s,F1,KK3,12,2,n),[s,l]=R(s,r,l,o,i,F1,KK3,9,13,n),[i,r]=R(i,s,r,l,o,F1,KK3,12,9,n),[o,s]=R(o,i,s,r,l,F1,KK3,5,7,n),[l,i]=R(l,o,i,s,r,F1,KK3,15,10,n),[r,o]=R(r,l,o,i,s,F1,KK3,8,14,n),[s,l]=R(s,r,l,o,i,F0,KK4,8,12,n),[i,r]=R(i,s,r,l,o,F0,KK4,5,15,n),[o,s]=R(o,i,s,r,l,F0,KK4,12,10,n),[l,i]=R(l,o,i,s,r,F0,KK4,9,4,n),[r,o]=R(r,l,o,i,s,F0,KK4,12,1,n),[s,l]=R(s,r,l,o,i,F0,KK4,5,5,n),[i,r]=R(i,s,r,l,o,F0,KK4,14,8,n),[o,s]=R(o,i,s,r,l,F0,KK4,6,7,n),[l,i]=R(l,o,i,s,r,F0,KK4,8,6,n),[r,o]=R(r,l,o,i,s,F0,KK4,13,2,n),[s,l]=R(s,r,l,o,i,F0,KK4,6,13,n),[i,r]=R(i,s,r,l,o,F0,KK4,5,14,n),[o,s]=R(o,i,s,r,l,F0,KK4,15,0,n),[l,i]=R(l,o,i,s,r,F0,KK4,13,3,n),[r,o]=R(r,l,o,i,s,F0,KK4,11,9,n),[s,l]=R(s,r,l,o,i,F0,KK4,11,11,n),t=(e[1]+c+l)%4294967296,e[1]=(e[2]+u+o)%4294967296,e[2]=(e[3]+_+i)%4294967296,e[3]=(e[4]+a+s)%4294967296,e[4]=(e[0]+d+r)%4294967296,e[0]=t,e}function RIPEMD160(e){let t=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]);const n=pad_ripemd(e),i=32*n.length;let s,r,l="";for(let e=0;e<i/512;e++){s=new Uint32Array(16);for(let t=0;t<16;t++)s[t]=n[16*e+t];t=RIPEMD160Transform(t,s)}return t.forEach((function(e){r=e.toString(16).padStart(8,"0"),l+=changeEndianness(r)})),l}function gen_bigRandom_int(){const e=new Uint8Array(32),t=window.crypto.getRandomValues(e);let n,i="0b";t.forEach((function(e){n=e.toString(2).padStart(8,"0"),i+=n}));return BigInt(i)}function gen_secret_key(){let e;for(;e=gen_bigRandom_int(),!(e<ORD_G););return e}class PublicKey extends Point{static from_sk(e){if("bigint"!=typeof e)throw new Error("sk must be BigInt type");const t=G.multiply(e);return new PublicKey(t.x,t.y)}decode(e){if("string"!=typeof e)throw new Error("Public Key must be hex string");if("04"===e.substring(0,2)){const t=BigInt("0x"+e.substring(2,66)),n=BigInt("0x"+e.substring(66,130));return new PublicKey(t,n)}const t="02"===e.substring(0,2),n=BigInt("0x"+e.substring(2)),i=(n*n%this.p*n+7n)%this.p;let s=i;for(let e=1n;e<(this.p+1n)/4n;e++)s=s*i%this.p;return s=s%2n===0n===t?s:this.p-s,new PublicKey(n,s)}encode(e,t=!0){let n,i,s,r;if(e?(n=this.y%2n===0n?"02":"03",i=n+this.x.toString(16).padStart(64,"0")):(n="04",s=this.x.toString(16).padStart(64,"0"),r=this.y.toString(16).padStart(64,"0"),i=n+s+r),t){return RIPEMD160(sha256(i))}return i}bitcoin_address(e,t,n){let i;"main"===e?i="00":"test"===e&&(i="6f");const s=i+this.encode(t,n);return b58encode(s+sha256(sha256(s)).substring(0,8))}}function calc_HD_key(e,t){const n=e.toString(16).padStart(8,"0"),i=sha256(n+t.toString(16).padStart(64,"0"));return sha256(n+i)}const ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",btc_addr_1=document.getElementById("addr-1");let MASTER_PRIVATE_KEY,CLICK_COUNTER=0,MASTER_SEED=0;function b58encode(e){let t=BigInt("0x"+e);const n=[];let i;for(;t;)i=t%58n,t/=58n,n.push(ALPHABET[i]);let s=0;for(;"00"===e.substring(2*s,2*s+2);)s+=1;if(0===s)return n.reverse().join("");return s*ALPHABET[0]+n.reverse().join("")}btc_addr_1.addEventListener("click",(function(){let e;for(CLICK_COUNTER+=1,1===CLICK_COUNTER&&(MASTER_PRIVATE_KEY=gen_secret_key(),document.getElementById("master_privkey").value=`${MASTER_PRIVATE_KEY}`);e=calc_HD_key(MASTER_SEED,MASTER_PRIVATE_KEY),e=BigInt("0x"+e),!(e<ORD_G);)MASTER_SEED+=1;1===CLICK_COUNTER&&(document.getElementById("master_seed").value=MASTER_SEED);const t=PublicKey.from_sk(e).bitcoin_address("test",!0,!0);document.getElementById("saved_addr1").value=t,document.getElementById("seed1").value=MASTER_SEED,btc_addr_1.nextElementSibling.value=t;const n=document.createElement("a");n.id="temp-id1",n.setAttribute("href",`https://www.blockchain.com/btc-testnet/address/${t}`),n.setAttribute("target","_blank"),n.appendChild(document.createTextNode("Verify that this address has never transacted before"));const i=document.getElementById("link-1");if(0===i.children.length)i.appendChild(n);else{const e=document.getElementById("temp-id1");i.replaceChild(n,e)}MASTER_SEED+=1})),document.getElementById("cal_address_btn").disabled=!0,document.getElementById("privKey_enter").addEventListener("click",(e=>{e.target.disabled=!0,e.target.classList.remove("btn-outline-dark"),e.target.classList.add("btn-outline-secondary");const t=document.getElementById("cal_address_btn");t.classList.remove("btn-outline-secondary"),t.classList.add("btn-outline-primary"),t.disabled=!1,document.getElementById("master_privkey").readOnly=!1;const n=document.getElementById("master_seed");n.readOnly=!1,n.value=0})),document.getElementById("cal_address_btn").addEventListener("click",(e=>{if(!document.getElementById("master_privkey").readOnly){e.target.disabled=!0;const t=BigInt(document.getElementById("master_privkey").value),n=parseInt(document.getElementById("master_seed").value);let i;0===n?i=t:(i=calc_HD_key(n,t),i=BigInt("0x"+i));const s=PublicKey.from_sk(i).bitcoin_address("test",!0,!0);document.getElementById("cal_address").value=s}}));class Signature{constructor(e,t){this.r=e,this.s=t}decode(e){if("30"!==e.substring(0,2))throw new Error("der initial marker is not correct");let t=e.substring(2,4);if(t=parseInt(t,16),t!==e.length-2)throw new Error("der length is not correct");if("02"!==e.substring(4,6))throw new Error("der r marker is not correct");let n=e.substring(6,8);n=parseInt(n,16);let i=e.substring(8,8+n);if(i=BigInt("0x"+i),"02"!==e.substring(8+n,8+n+2))throw new Error("der s marker is not correct");let s=e.substring(8+n+2,8+n+2+2);s=parseInt(s,16);let r=e.substring(8+n+2+2,8+n+2+2+s);if(i=BigInt("0x"+r),e.length!==6+n+s)throw new Error("der signature Length mismatch");return Signature(i,r)}encode(){function e(e){let t=e.toString(16).padStart(64,"0"),n=0;for(;"00"===t.substring(2*n,2*n+2);)n+=1;return t=t.substring(n),parseInt(t.substring(0,2),16)>=128&&(t="00"+t),t}const t=e(this.r),n=e(this.s),i="02"+parseInt(t.length/2).toString(16).padStart(2,"0")+t,s="02"+parseInt(n.length/2).toString(16).padStart(2,"0")+n;let r="30"+parseInt((i.length+s.length)/2).toString(16).padStart(2,"0");return r=r+i+s,r}}function sign(e,t){let n=sha256(sha256(t));n=BigInt("0x"+n);const i=gen_secret_key(),s=PublicKey.from_sk(i).x;let r=(n+e*s)*inverse(i,ORD_G)%ORD_G;return r>ORD_G/2n&&(r=ORD_G-r),new Signature(s,r)}function verify(e,t,n){if("bigint"!=typeof n.r&&n.r>ORD_G&&n.r<1)throw new Error("signature, r incorrect.");if("bigint"!=typeof n.s&&n.s>ORD_G&&n.s<1)throw new Error("signature, s incorrect.");let i=sha256(sha256(t));i=BigInt("0x"+i),w=inverse(n[1],ORD_G);const s=i*w%ORD_G,r=n[0]*w%ORD_G;return G.multiply(s).add(e.multiply(r)).x===n.r}function little_endian_to_int(e,t){if(t>1){const t=[];for(let n=0;n<e.length/2;n++)t.unshift(e.substring(2*n,2*n+2));return parseInt(t.join(""),16)}return parseInt(e,16)}function int_to_little_endian(e,t){const n=e.toString(16).padStart(2*t,"0");if(t>1){const e=[];for(let t=0;t<n.length/2;t++)e.unshift(n.substring(2*t,2*t+2));return e.join("")}return n}function big_to_little_endian(e){const t=[];for(let n=0;n<e.length/2;n++)t.unshift(e.substring(2*n,2*n+2));return t.join("")}function little_to_big_endian(e){const t=[];for(let n=0;n<e.length/2;n++)t.unshift(e.substring(2*n,2*n+2));return t.join("")}function encode_varint(e){if(e<253)return int_to_little_endian(e,1);if(e<65536)return"fd"+int_to_little_endian(e,2);if(e<4294967296)return"fe"+int_to_little_endian(e,4);if(e<0x10000000000000000)return"ff"+int_to_little_endian(e,8);throw new Error(`integer too large: ${e}`)}function decode_varint(e){const t=little_endian_to_int(e.substring(0,2),1);return 253===t?[little_endian_to_int(e.substring(2,6),2),e.substring(6)]:254===t?[little_endian_to_int(e.substring(2,10),4),e.substring(10)]:255===t?[little_endian_to_int(e.substring(2,18),8),e.substring(18)]:[t,e.substring(2)]}class TxIn{constructor(e,t,n,i=4294967295){this.prev_tx_id=e,this.tx_index=t,this.script_sig=n,this.sequence=i,this.witness=null,this.net="test"}static decode(e,t){const n=little_to_big_endian(e.substring(0,64)),i=little_endian_to_int(e.substring(64,72),4);let[s,r]=decode_varint(e.substring(36));const l=Script.decode(r.substring(0,s));little_endian_to_int(r.substring(s,s+8),4);return{TxIn_Obj:new TxIn(n,i,l),remaining_str:r.substring(s+8)}}encode(e){const t=[];if(t.push(big_to_little_endian(this.prev_tx_id)),t.push(int_to_little_endian(this.tx_index,4)),null===e)t.push(this.script_sig.encode());else if(!0===e)t.push(this.script_sig.encode());else{if(!1!==e)throw new Error("script_override must be one of null|true|false");t.push(new Script([]).encode())}return t.push(int_to_little_endian(this.sequence,4)),t.join("")}get_value(){return TxFetcher.fetch(this.prev_tx_id,net=this.net).tx_outs[this.prev_tx_id].amount}script_pubkey(){return TxFetcher.fetch(this.prev_tx_id,net=this.net).tx_outs[this.tx_index].script_pubkey}}class TxOut{constructor(e,t){this.amount=e,this.script_pubkey=t}static decode(e){const t=little_endian_to_int(e.substring(0,16),8),n=Script.decode(e.substring(8));return{TxOut_Obj:new TxOut(t,n.script_obj),remaining_str:n.remaining_str}}encode(){const e=[];return e.push(int_to_little_endian(this.amount,8)),e.push(this.script_pubkey.encode()),e.join("")}}class Tx{constructor(e,t,n,i,s){this.version=e,this.tx_ins=t,this.tx_outs=n,this.locktime=i,this.segwit=s}static decode(e){const t=little_endian_to_int(e.substring(0,8),4);let n,i,s=!1;"00"===e.substring(8,10)?"01"===e.substring(10,12)&&([n,i]=decode_varint(e.substring(12)),s=!0,console.log(`s: ${i}`)):[n,i]=decode_varint(e.substring(8));const r=[];let l;for(let e=0;e<n;e++)l=TxIn.decode(i,this.segwit),r.push(l.TxIn_Obj),i=l.remaining_str;[num_outputs,i]=decode_varint(i);const o=[];let a;for(let e=0;e<num_outputs;e++)a=TxOut.decode(i),o.push(a.TxOut_Obj),i=a.remaining_str;if(s){let e,t,n;for(let s=0;s<r.length;s++){[e,i]=decode_varint(i),t=[];for(let s=0;s<e;s++)[n,i]=decode_varint(i),0===n?t.push(0):t.push(i.substring(0,n));r[s].witness=t}}const d=little_endian_to_int(i,4);return new Tx(t,r,o,d,s)}encode(e,t=-1){const n=[];return n.push(int_to_little_endian(this.version,4)),this.segwit&&!e&&n.push("0001"),n.push(encode_varint(this.tx_ins.length)),-1===t?this.tx_ins.forEach((function(e){n.push(e.encode(!0))})):this.tx_ins.forEach((function(e,i){t===i?n.push(e.encode(!0)):n.push(e.encode(!1))})),n.push(encode_varint(self.tx_outs.length)),this.tx_outs.forEach((function(e){n.push(e.encode())})),this.segwit&&!e&&this.tx_ins.forEach((function(e){n.push(encode_varint(e.witness.length)),e.witness.forEach((function(e){"number"==typeof e?n.push(encode_varint(e)):(n.push(encode_varint(e.length)),n.push(e))}))})),n.push(int_to_little_endian(this.locktime,4)),-1!==t&&n.push(int_to_little_endian(1,4)),n.join("")}id(){return big_to_little_endian(sha256(sha256(this.encode(!0,-1))))}fee(){let e=0,t=0;return this.tx_ins.forEach((function(t){e+=t.get_value()})),this.tx_outs.forEach((function(e){t+=e.amount})),e-t}validate(){if(this.segwit&&console.log("can not validate the segwit transaction."),this.fee()<0)return!1;let e,t,n;return this.tx_ins.forEach((function(i,s){if(e=this.encode(!1,s),t=i.script_sig.concate(i.script_pubkey()),n=t.evaluate(e),!n)return!1})),!0}is_coinbase(){const e=this.tx_ins[0];return 1===this.tx_ins.length&&"0000000000000000"===e.prev_tx_id&&4294967295===e.tx_index}coinbase_height(){return this.is_coinbase()?int_from_little(this.tx_ins[0].script_sig.cmds[0]):null}}class Script{constructor(e){this.cmds=e}static decode(e){let[t,n]=decode_varint(e);const i=[];let s,r,l,o,a=0;for(;a<t;)s=n.substring(0,2),a+=1,r=parseInt(s),r>=1&&r<=75?(i.push(n.substring(2,2*r)),a+=r,n=n.slice(2+2*r)):76===r?(l=little_endian_to_int(n.substring(2,4),1),i.push(n.substring(4,2*l)),a+=l+1,n=n.slice(4+2*l)):77===r?(l=little_endian_to_int(n.substring(2,6),2),i.push(n.substring(6,2*l)),a+=l+2,n=n.slice(6+2*l)):(o=r,i.push(o),n=n.slice(2));if(a!==t)throw new Error("parsing script failed");return{script_obj:new Script(i),remaining_str:n}}encode(){let e,t="";this.cmds.forEach((function(n){if("number"==typeof n)t+=int_to_little_endian(n,1);else{if(e=parseInt(n.length/2),e<75)t+=int_to_little_endian(e,1);else if(e>=76&&e<=255)t+=int_to_little_endian(76,1),t+=int_to_little_endian(e,1);else{if(!(e>=256&&e<=520))throw new Error(`cmd of length ${e} bytes is too long?`);t+=int_to_little_endian(77,1),t+=int_to_little_endian(e,2)}t+=n}}));return encode_varint(parseInt(t.length/2))+t}evaluate(e){if(7!==this.cmds.length)return!1;const t=this.cmds[1];if(this.cmds[4]!==RIPEMD160(sha256(t)))return!1;if(1!==this.cmds[0].substring(-1))return!1;const n=this.cmds[0].substring(0,-1),i=this.cmds[1],s=Signature.decode(n);return verify(PublicKey.decode(i),e,s)}}const ALPHABET_DECODE="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";function address_to_pkb_hash(e){let t=0n;for(let n=0;n<e.length;n++)t*=58n,t+=BigInt(ALPHABET_DECODE.indexOf(e[n]));const n=t.toString(16).padStart(50,"0"),i=sha256(sha256(n.substring(0,42)));if(n.substring(42)!==i.substring(0,8)){const e="Address is not correct, Please check again";console.log(e)}return n.substring(2,42)}document.getElementById("sender_addr").addEventListener("blur",valSenderAddr),document.getElementById("prev_tx_id1").addEventListener("blur",valTxid),document.getElementById("prev_tx_index1").addEventListener("blur",valIndex),document.getElementById("address1").addEventListener("blur",valAddress),document.getElementById("amount1").addEventListener("blur",valAmount),document.getElementById("address2").addEventListener("blur",valAddress),document.getElementById("amount2").addEventListener("blur",valAmount),document.getElementById("add_recipient").addEventListener("click",addRecipient),document.getElementById("remove_recipient").addEventListener("click",removeRecipient),document.getElementById("add_sender").addEventListener("click",addSender),document.getElementById("remove_sender").addEventListener("click",removeSender),document.getElementById("sign").addEventListener("click",VerifyInputs);const sender_bool=[!1,!1],recipient_bool=[!1,!1,!1,!1],canSubmit=[!1,!0,!0,sender_bool,recipient_bool];document.getElementById("sign").disabled=!0;let num_sender=1,sender_class_counter=2,num_recipient=2,recipient_class_counter=4;const INPUT_CONTENT=[],OUTPUT_CONTENT=[],SIGN_CONTENT=[];function valSenderAddr(e){valAlphanumeric(e,"Address",34,canSubmit,SIGN_CONTENT)}function valTxid(e){valAlphanumeric(e,"ID",64,sender_bool,INPUT_CONTENT)}function valIndex(e){valNumeric(e,"Index",sender_bool,INPUT_CONTENT)}function valAddress(e){valAlphanumeric(e,"Address",34,recipient_bool,OUTPUT_CONTENT)}function valAmount(e){valNumeric(e,"Amount",recipient_bool,OUTPUT_CONTENT)}function valAlphanumeric(e,t,n,i,s){const r=e.target.value.length,l=e.target.value,o=e.target.classList,a=e.target.parentElement.nextElementSibling;let d=o[0];d=parseInt(d.match(/\d+/)[0]),0===r?i[d]=!1:r!==n?(o.contains("is-invalid")?a.innerHTML=`<small>The length of ${t} must be ${n}</small>`:(o.add("is-invalid"),a.innerHTML=`<small>The length of ${t} must be ${n}</small>`,o.contains("is-valid")&&o.remove("is-valid")),i[d]=!1):r===n&&(null===l.match(/^[a-zA-Z0-9]*$/)?(o.contains("is-invalid")?a.innerHTML="<small>only alphaNumeric characters allowed</small>":(o.add("is-invalid"),a.innerHTML="<small>only alphaNumeric characters allowed</small>",o.contains("is-valid")&&o.remove("is-valid")),i[d]=!1):(o.contains("is-valid")||(o.add("is-valid"),0!==a.children.length&&(a.innerHTML=""),o.contains("is-invalid")&&o.remove("is-invalid")),s[d]=l,i[d]=!0)),checkSubmit()}function valNumeric(e,t,n,i){const s=e.target.value.length;let r=e.target.value;const l=e.target.classList,o=e.target.parentElement.nextElementSibling;let a=l[0];a=parseInt(a.match(/\d+/)[0]),0===s?(l.contains("is-invalid")?o.innerHTML="<small>Enter valid Integer</small>":(l.add("is-invalid"),o.innerHTML="<small>Enter valid Integer</small>",l.contains("is-valid")&&l.remove("is-valid")),n[a]=!1):-1!==r.indexOf(".")?(l.contains("is-invalid")?o.innerHTML=`<small>${t} must be +ve Integer</small>`:(l.add("is-invalid"),o.innerHTML=`<small>${t} must be +ve Integer</small>`,l.contains("is-valid")&&l.remove("is-valid")),n[a]=!1):-1!==r.indexOf("-")?(l.contains("is-invalid")?o.innerHTML=`<small>${t} can not be -ve.</small>`:(l.add("is-invalid"),o.innerHTML=`<small>${t} can not be -ve.</small>`,l.contains("is-valid")&&l.remove("is-valid")),n[a]=!1):(r=parseInt(r),l.contains("is-valid")||(l.add("is-valid"),0!==o.children.length&&(o.innerHTML=""),l.contains("is-invalid")&&l.remove("is-invalid")),i[a]=r,n[a]=!0),checkSubmit()}function checkSubmit(){let e=0;canSubmit.forEach((function(t){Array.isArray(t)?t.forEach((function(t){t&&(e+=1)})):t&&(e+=1)}));const t=canSubmit.length+sender_bool.length+recipient_bool.length-2;document.getElementById("sign").disabled=e!==t}function addSender(e){num_sender+=1;const t=document.getElementById(`sender${num_sender}`);if(t.innerHTML=`<label class="output-label mb-1">${num_sender}. Previous Transaction</label>\n        <div class="input-group">\n            <span class="input-group-text span-color">ID (Hash)</span>\n            <input type="text" class="num${sender_class_counter} form-control" id="prev_tx_id${num_sender}" placeholder="9796533c33e46d94a9c1db451758c2b6ecc06e199b91c6515f7fee0e3fc54afc">\n        </div>\n        <p class="warning"></p>\n        <div style="width:50%" class="input-group">\n            <span class="input-group-text span-color">Index</span>\n            <input type="number" class="num${sender_class_counter+1} form-control" id="prev_tx_index${num_sender}" placeholder="0">\n        </div>\n        <p class="warning"></p>`,sender_class_counter+=2,2===num_sender){const e=document.getElementById("remove_sender");e.classList.remove("btn-outline-secondary"),e.classList.add("btn-outline-danger")}const n=`<div id="sender${num_sender+1}" class="box"></div>`;t.insertAdjacentHTML("afterend",n);const i=document.getElementById(`prev_tx_id${num_sender}`),s=document.getElementById(`prev_tx_index${num_sender}`);i.addEventListener("blur",valTxid),s.addEventListener("blur",valIndex),sender_bool.push(!1),sender_bool.push(!1),checkSubmit(),calculateFee()}function removeSender(e){if(num_sender>1){if(document.getElementById(`sender${num_sender}`).remove(),document.getElementById(`sender${num_sender+1}`).id=`sender${num_sender}`,num_sender-=1,1===num_sender){const e=document.getElementById("remove_sender");e.classList.add("btn-outline-secondary"),e.classList.remove("btn-outline-danger")}sender_class_counter-=2,sender_bool.pop(),sender_bool.pop(),INPUT_CONTENT.pop(),INPUT_CONTENT.pop(),checkSubmit(),calculateFee()}}function addRecipient(e){num_recipient+=1;const t=document.getElementById(`recipient${num_recipient}`);if(t.innerHTML=`<label class="output-label mb-1">Recipient: ${num_recipient}</label>\n        <div class="input-group">\n            <span class="input-group-text span-color">Address</span>\n            <input type="text" class="num${recipient_class_counter} form-control" id="address${num_recipient}" placeholder="mohjSavDdQYHRYXcS3uS6ttaHP8amyvX78">\n        </div>\n        <p class="warning"></p>\n        <div class="small-box input-group">\n            <span class="input-group-text span-color">Amount</span>\n            <input type="number" class="num${recipient_class_counter+1} form-control" id="amount${num_recipient}" placeholder="10000 (in satoshi)">\n        </div>\n        <p class="warning"></p>`,recipient_class_counter+=2,2===num_recipient){const e=document.getElementById("remove_recipient");e.classList.remove("btn-outline-secondary"),e.classList.add("btn-outline-danger")}const n=`<div id="recipient${num_recipient+1}" class="box"></div>`;t.insertAdjacentHTML("afterend",n);const i=document.getElementById(`address${num_recipient}`),s=document.getElementById(`amount${num_recipient}`);i.addEventListener("blur",valAddress),s.addEventListener("blur",valAmount),recipient_bool.push(!1),recipient_bool.push(!1),checkSubmit(),calculateFee()}function removeRecipient(e){if(num_recipient>1){if(document.getElementById(`recipient${num_recipient}`).remove(),document.getElementById(`recipient${num_recipient+1}`).id=`recipient${num_recipient}`,num_recipient-=1,1===num_recipient){const e=document.getElementById("remove_recipient");e.classList.remove("btn-outline-danger"),e.classList.add("btn-outline-secondary")}recipient_class_counter-=2,recipient_bool.pop(),recipient_bool.pop(),OUTPUT_CONTENT.length>2&&(OUTPUT_CONTENT.pop(),OUTPUT_CONTENT.pop()),checkSubmit(),calculateFee()}}function checkAddress(){let e=0;CAL_ADDRESS_TRACKER.forEach((t=>{t&&(e+=1)})),e===CAL_ADDRESS_TRACKER.length?document.getElementById("cal_address_btn").disabled=!1:document.getElementById("cal_address_btn").disabled=!0}function calculateFee(){const e=5+147*num_sender+1+34*num_recipient+4,t=e+(50-e%50);let n=t/e;n=n.toFixed(2),document.getElementById("fee").value=`${t} Satoshi, ${n}sats/byte`}function VerifyInputs(e){e.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status"></span>\n                            Verifying...',e.target.disabled=!0;const t=BigInt(document.getElementById("master_privkey").value),n=parseInt(document.getElementById("master_seed").value);let i;0===n?i=t:(i=calc_HD_key(n,t),i=BigInt("0x"+i));if(PublicKey.from_sk(i).bitcoin_address("test",!0,!0)!==SIGN_CONTENT[0]){const e=document.getElementById("sender_addr");e.classList.remove("is-valid"),e.classList.add("is-invalid"),e.parentElement.nextElementSibling.innerHTML="<small>Address mismatch, Incorrect Sender address or Master PrivateKey/Seed.</small>"}let s=0;for(let e=0;e<OUTPUT_CONTENT.length;e+=2)s+=OUTPUT_CONTENT[e+1];let r,l,o=0;function a(e,t,n){return new Promise(((i,s)=>{fetch(t,{method:"GET",redirect:"follow"}).then((t=>t.ok?t.json():(t.text().then((()=>{r=document.getElementById(`prev_tx_id${e}`),r.classList.remove("is-valid"),r.classList.add("is-invalid"),l=r.parentElement.nextElementSibling,l.innerHTML="<small>Transaction not Found on Blockchain</small>",document.getElementById("sign").innerText="Verify & Sign"})),Promise.reject()))).then((t=>{let s;if(void 0===t.vout[n]){let t=document.getElementById(`prev_tx_index${e}`);t.classList.remove("is-valid"),t.classList.add("is-invalid"),s=t.parentElement.nextElementSibling,s.innerHTML="<small>Index does not exist.</small>",document.getElementById("sign").innerText="Verify & Sign"}else if(t.vout[n].scriptpubkey_address!==SIGN_CONTENT[0]){let e=document.getElementById("sender_addr");e.classList.remove("is-valid"),e.classList.add("is-invalid"),s=e.parentElement.nextElementSibling,s.innerHTML="<small>Address mismatch, Please check the Sender address or Tx Index</small>",document.getElementById("sign").innerText="Verify & Sign"}else o+=t.vout[n].value;i()})).catch((e=>{if(void 0!==e){document.getElementById("info_block").innerHTML=`<h3 style="color: #AF0606">Network Error</h3><p>${e}</p>`,document.getElementById("sign").innerText="Verify & Sign"}}))}))}const d=[];id_grab_counter=0;for(let e=0;e<INPUT_CONTENT.length;e+=2)id_grab_counter+=1,d.push(a(id_grab_counter,`https://blockstream.info/testnet/api/tx/${INPUT_CONTENT[e]}`,INPUT_CONTENT[e+1]));Promise.all(d).then((()=>{const t=o-s,n=document.getElementById("info_block");if(t<0)n.innerHTML=`<h3 style="color: #AF0606;">Invalid: Overspending ${Math.abs(t)} Satoshi</h3>\n                                        <p style="font-weight: bold; font-size: 1.5rem">Only have ${o} satoshi, spending ${s} satoshi</p>`,document.getElementById("sign").innerText="Verify & Sign";else{const i=parseInt(document.getElementById("fee").value);t<i?(n.innerHTML=`<h3 style="color: #AF0606;">Invalid: Fee less than Minimum recommended fee.</h3>\n                                                <p style="font-weight: bold; font-size: 1.5rem">Subtract ${i-t} satoshi from Any of the Amount field.</p>`,document.getElementById("sign").innerText="Verify & Sign"):(document.getElementById("sign").innerText="Verify & Sign",Sign(e))}}))}function Sign(e){const t=[];let n;const i=address_to_pkb_hash(SIGN_CONTENT[0]),s=new Script([118,169,i,136,172]);for(let e=0;e<INPUT_CONTENT.length;e+=2)n=new TxIn(prev_tx_id=INPUT_CONTENT[e],tx_index=INPUT_CONTENT[e+1],script_sig=null),n.script_sig=s,t.push(n);const r=[];let l,o,a;for(let e=0;e<OUTPUT_CONTENT.length;e+=2)o=address_to_pkb_hash(OUTPUT_CONTENT[e]),l=new TxOut(amount=OUTPUT_CONTENT[e+1],script_pubkey=null),a=new Script([118,169,o,136,172]),l.script_pubkey=a,r.push(l);const d=new Tx(version=1,tx_ins=t,tx_outs=r,locktime=0,segwit=!1),c=BigInt(document.getElementById("master_privkey").value),u=parseInt(document.getElementById("master_seed").value);let _;0===u?_=c:(_=calc_HD_key(u,c),_=BigInt("0x"+_));const m=PublicKey.from_sk(_).encode(!0,!1);let g,h,p,f,v;for(let e=0;e<t.length;e++)g=d.encode(!0,e),h=sign(_,g),p=h.encode(),f=p+"01",v=new Script([f,m]),d.tx_ins[e].script_sig=v;const b=d.encode(!0);let K=sha256(sha256(b));K=big_to_little_endian(K);const F=document.getElementById("info_block");F.innerHTML=`<h3 style="color: rgb(33, 37, 41);" class="box">Broadcast raw transaction (hex)</h3>\n        <div id="output_tx" class="input-group box mb-3">\n        <textarea style="color: rgb(33, 37, 41);" class="form-control form-control-sm" rows="6" disabled>${b}</textarea>\n    </div>\n    <button type="button" id="broadcast" class="btn btn-success mb-3">BroadCast</button>`,document.getElementById("broadcast").addEventListener("click",(function(e){e.target.innerHTML='<span class="spinner-border spinner-border-sm" role="status"></span>\n                            BroadCasting...',e.target.disabled=!0;let t=new Headers;t.append("Content-Type","text/plain"),fetch("https://blockstream.info/testnet/api/tx",{method:"POST",headers:t,mode:"cors",redirect:"follow",body:b}).then((e=>e.ok?e.text():(e.text().then((e=>{F.innerHTML=`<h3 style="color: #AF0606">Invalid Transaction</h3><p>${e}</p>`,document.getElementById("sign").innerText="Verify & Sign"})),Promise.reject()))).then((t=>{F.previousElementSibling.style.display="none",e.target.remove(),F.innerHTML=`<h3 style="color: green">Congratulations: Transaction Successful.</h3>\n                    <p>Wait 5-10sec for link to be active.\n                    <a href="https://www.blockchain.com/btc-testnet/tx/${t}" target="_blank">Check Transaction Status</a></p>`,document.getElementById("sign").innerText="Verify & Sign"})).catch((e=>{if(void 0!==e){document.getElementById("info_block").innerHTML=`<h3 style="color: #AF0606">Network Error</h3><p>${e}</p>`,document.getElementById("sign").innerText="Verify & Sign"}}))}))}CAL_ADDRESS_TRACKER=[!0,!1,!1],document.getElementById("master_privkey").addEventListener("blur",(e=>{if(!document.getElementById("master_privkey").readOnly){const t=e.target.classList,n=e.target.parentElement.nextElementSibling;let i=e.target.value;const s=parseInt(t[0].match(/\d+/)[0]);0===i.length?(canSubmit[s]=!1,CAL_ADDRESS_TRACKER[s]=!1,t.contains("is-invalid")?n.innerHTML="<small>Enter valid Integer</small>":(t.add("is-invalid"),n.innerHTML="<small>Enter valid Integer</small>",t.contains("is-valid")&&t.remove("is-valid"))):i.match(/\d+/)[0].length!==i.length?(t.contains("is-invalid")||(t.add("is-invalid"),n.innerHTML="<small>Not a +ve number</small>",t.contains("is-valid")&&t.remove("is-valid")),canSubmit[s]=!1,CAL_ADDRESS_TRACKER[s]=!1):(t.contains("is-valid")||(t.add("is-valid"),0!==n.children.length&&(n.innerHTML=""),t.contains("is-invalid")&&t.remove("is-invalid")),CAL_ADDRESS_TRACKER[s]=!0,canSubmit[s]=!0,SIGN_CONTENT[s]=BigInt(i.match(/\d+/)[0])),checkSubmit(),checkAddress()}})),document.getElementById("master_seed").addEventListener("blur",(e=>{if(!document.getElementById("master_seed").readOnly){const t=e.target.value.length;let n=e.target.value;const i=e.target.classList,s=e.target.parentElement.nextElementSibling;let r=i[0];r=parseInt(r.match(/\d+/)[0]),0===t?(i.contains("is-invalid")?s.innerHTML="<small>Enter valid Integer</small>":(i.add("is-invalid"),s.innerHTML="<small>Enter valid Integer</small>",i.contains("is-valid")&&i.remove("is-valid")),canSubmit[r]=!1,CAL_ADDRESS_TRACKER[r]=!1):-1!==n.indexOf(".")?(i.contains("is-invalid")?s.innerHTML="<small>must be +ve Integer</small>":(i.add("is-invalid"),s.innerHTML="<small>must be +ve Integer</small>",i.contains("is-valid")&&i.remove("is-valid")),canSubmit[r]=!1,CAL_ADDRESS_TRACKER[r]=!1):-1!==n.indexOf("-")?(i.contains("is-invalid")?s.innerHTML="<small>Seed can not be -ve.</small>":(i.add("is-invalid"),s.innerHTML="<small>Seed can not be -ve.</small>",i.contains("is-valid")&&i.remove("is-valid")),canSubmit[r]=!1,CAL_ADDRESS_TRACKER[r]=!1):(n=parseInt(n),n>=0&&n<=2**32-1?(i.contains("is-valid")||(i.add("is-valid"),0!==s.children.length&&(s.innerHTML=""),i.contains("is-invalid")&&i.remove("is-invalid")),SIGN_CONTENT[r]=n,canSubmit[r]=!0,CAL_ADDRESS_TRACKER[r]=!0):(i.contains("is-invalid")?s.innerHTML="<small>must be +ve and less than 4294967296</small>":(i.add("is-invalid"),s.innerHTML="<small>must be +ve and less than 4294967296</small>",i.contains("is-valid")&&i.remove("is-valid")),canSubmit[r]=!1,CAL_ADDRESS_TRACKER[r]=!1)),checkSubmit(),checkAddress()}}));